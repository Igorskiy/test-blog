{"ast":null,"code":"import _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Layout from '../../components/MyLayout';\nimport { getPostFromServer, sendCommentOnServer } from '../../api';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { setCommentBody, setPost } from '../../store/actions';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport Paper from '@material-ui/core/Paper';\nimport { Button, TextField } from '@material-ui/core';\nvar useStyles = makeStyles(function (theme) {\n  return createStyles({\n    textField: {\n      marginTop: '25px',\n      marginBottom: '10px',\n      maxWidth: '60%',\n      justifyContent: 'center'\n    },\n    root: {\n      flexGrow: 1,\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center'\n    },\n    paper: {\n      minHeight: '60vh',\n      maxWidth: '90vw',\n      marginTop: '20px',\n      marginRight: '20px',\n      marginLeft: '20px',\n      padding: theme.spacing(2),\n      textAlign: 'center',\n      color: theme.palette.text.primary,\n      outline: 'none',\n      cursor: 'pointer'\n    },\n    comment: {\n      display: 'flex',\n      alignItems: 'center',\n      width: 'max-content',\n      paddingTop: '5px',\n      paddingLeft: '15px',\n      paddingRight: '15px',\n      marginTop: '15px',\n      maxWidth: '30vw',\n      minHeight: '50px'\n    },\n    post: {\n      paddingBottom: '20px'\n    },\n    commentTitle: {\n      fontWeight: 'bold',\n      paddingTop: '15px'\n    }\n  });\n});\n\nvar PostPage = function PostPage() {\n  var classes = useStyles();\n  var dispatch = useDispatch();\n  var commentBody = useSelector(function (state) {\n    return state.inputs.commentBody;\n  });\n  var post = useSelector(function (state) {\n    return state.posts.post;\n  });\n\n  var addComment = function addComment(postId, commentBody) {\n    return _regeneratorRuntime.async(function addComment$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!commentBody.trim()) {\n              _context.next = 13;\n              break;\n            }\n\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(sendCommentOnServer(postId, commentBody));\n\n          case 3:\n            _context.t0 = dispatch;\n            _context.t1 = setPost;\n            _context.next = 7;\n            return _regeneratorRuntime.awrap(getPostFromServer(postId));\n\n          case 7:\n            _context.t2 = _context.sent;\n            _context.t3 = (0, _context.t1)(_context.t2);\n            (0, _context.t0)(_context.t3);\n            dispatch(setCommentBody(''));\n            _context.next = 14;\n            break;\n\n          case 13:\n            alert(\"Your comment is empty, please, fill it.\");\n\n          case 14:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, _Promise);\n  };\n\n  return __jsx(Layout, null, __jsx(\"div\", {\n    className: classes.root\n  }, __jsx(Paper, {\n    className: classes.paper,\n    onClick: function _callee() {\n      return _regeneratorRuntime.async(function _callee$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.t0 = dispatch;\n              _context2.t1 = setPost;\n              _context2.next = 4;\n              return _regeneratorRuntime.awrap(getPostFromServer(post.id));\n\n            case 4:\n              _context2.t2 = _context2.sent;\n              _context2.t3 = (0, _context2.t1)(_context2.t2);\n              return _context2.abrupt(\"return\", (0, _context2.t0)(_context2.t3));\n\n            case 7:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, _Promise);\n    }\n  }, __jsx(Paper, {\n    className: classes.post\n  }, __jsx(\"h1\", null, post.title), __jsx(\"p\", null, post.body)), __jsx(\"div\", null, __jsx(\"div\", null, __jsx(\"div\", {\n    className: classes.commentTitle\n  }, \"Comments:\"), post.comments ? post.comments.map(function (comment) {\n    return __jsx(Paper, {\n      key: comment.id,\n      className: classes.comment\n    }, __jsx(\"div\", null, comment.body));\n  }) : __jsx(\"div\", null, \"No comments yet\")), __jsx(\"div\", null, __jsx(TextField, {\n    id: \"outlined-multiline-flexible\",\n    className: classes.textField,\n    label: \"New comment\",\n    multiline: true,\n    rowsMax: \"100\",\n    fullWidth: true,\n    placeholder: \"Add your comment here\",\n    value: commentBody,\n    onChange: function onChange(e) {\n      return dispatch(setCommentBody(e.target.value));\n    },\n    variant: \"outlined\"\n  })), __jsx(Button, {\n    onClick: function onClick() {\n      return addComment(post.id, commentBody);\n    }\n  }, \"Add new comment\")))));\n};\n\nPostPage.getInitialProps = function _callee2(context) {\n  var id, post;\n  return _regeneratorRuntime.async(function _callee2$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          id = context.query.id;\n          _context3.next = 3;\n          return _regeneratorRuntime.awrap(getPostFromServer(+id));\n\n        case 3:\n          post = _context3.sent;\n          context.store.dispatch(setPost(post));\n          return _context3.abrupt(\"return\", {\n            post: post\n          });\n\n        case 6:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, null, null, null, _Promise);\n};\n\nexport default PostPage;","map":null,"metadata":{},"sourceType":"module"}